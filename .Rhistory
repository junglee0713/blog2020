scale_color_d3() +
geom_text_repel(aes(label = is.problem), nudge_x = 1) +
ylim(c(0, NA)) +
geom_hline(yintercept = alpha, color = "blue") +
theme_classic() +
theme(aspect.ratio = 1)
d <- d %>%
mutate(adj_pval = p.adjust(sorted_pval, method = "BH"))
d %>%
ggplot(aes(rank, adj_pval)) +
geom_point(aes(y = rev_pval)) +
geom_point(aes(color = sig)) +
scale_color_d3() +
ylim(c(0, NA)) +
geom_hline(yintercept = alpha, color = "blue") +
theme_classic() +
theme(aspect.ratio = 1)
d <- d %>%
mutate(adj_pval = p.adjust(sorted_pval, method = "BH"))
d %>%
ggplot(aes(rank, adj_pval)) +
geom_point(aes(y = rev_pval), shape = "wrong") +
geom_point(aes(color = sig), shape = "correct") +
scale_color_d3() +
ylim(c(0, NA)) +
geom_hline(yintercept = alpha, color = "blue") +
theme_classic() +
theme(aspect.ratio = 1)
d <- d %>%
mutate(adj_pval = p.adjust(sorted_pval, method = "BH"))
d %>%
ggplot(aes(rank, adj_pval)) +
geom_point(aes(y = rev_pval, shape = "wrong")) +
geom_point(aes(color = sig, shape = "correct")) +
scale_color_d3() +
ylim(c(0, NA)) +
geom_hline(yintercept = alpha, color = "blue") +
theme_classic() +
theme(aspect.ratio = 1)
xaringan:::inf_mr()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::update_meta_addin()
getwd()
blogdown:::serve_site()
getwd()
# Chunk 1
library(tidyverse)
library(ggrepel)
library(ggsci)
nom_pval <- c(0.01600000, 0.05865014, 0.08350898, 0.08783160, 0.06777848,
0.08206850, 0.01800000, 0.09725057, 0.00200000, 0.00010000,
0.04862445, 0.00300000, 0.01500000, 0.07574901, 0.05959104,
0.01900000, 0.01700000, 0.00400000, 0.02000000, 0.06827007)
n <- length(nom_pval)
d <- tibble(sorted_pval = sort(nom_pval), rank = 1:n)
# Chunk 2
alpha = 0.05
d <- d %>%
mutate(is.under = sorted_pval <= alpha/n*rank) %>%
mutate(is.last = ifelse(rank == which(.$is.under) %>% max(), "last rank\nunder the line", "")) %>%
mutate(sig = ifelse(rank <= which(.$is.under) %>% max(), "sig.", "non-sig."))
d %>%
ggplot(aes(rank, sorted_pval)) +
geom_point(aes(color = sig)) +
scale_color_d3() +
geom_text_repel(aes(label = is.last), nudge_x = 1) +
ylim(c(0, NA)) +
geom_abline(intercept = 0, slope = alpha/n, color = "red") +
theme_classic() +
theme(aspect.ratio = 1)
# Chunk 3
d <- d %>%
mutate(rev_pval = sorted_pval*n/rank) %>%
mutate(is.problem = ifelse(sig == "sig." & rev_pval > alpha, "problem", ""))
d %>%
ggplot(aes(rank, rev_pval)) +
geom_point(aes(color = sig)) +
scale_color_d3() +
geom_text_repel(aes(label = is.problem), nudge_x = 1) +
ylim(c(0, NA)) +
geom_hline(yintercept = alpha, color = "blue") +
theme_classic() +
theme(aspect.ratio = 1)
d <- d %>%
mutate(adj_pval = p.adjust(sorted_pval, method = "BH"))
d %>%
ggplot(aes(rank, adj_pval)) +
geom_point(aes(y = rev_pval, shape = "previous adjustment")) +
geom_point(aes(color = sig, shape = "correct adjustment")) +
scale_color_d3() +
ylim(c(0, NA)) +
geom_hline(yintercept = alpha, color = "blue") +
theme_classic() +
theme(aspect.ratio = 1)
d <- d %>%
mutate(adj_pval = p.adjust(sorted_pval, method = "BH"))
d %>%
ggplot(aes(rank, adj_pval)) +
geom_point(aes(y = rev_pval, shape = "previous adjustment")) +
geom_point(aes(color = sig, shape = "correct adjustment")) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval)) +
scale_color_d3() +
ylim(c(0, NA)) +
geom_hline(yintercept = alpha, color = "blue") +
theme_classic() +
theme(aspect.ratio = 1)
d <- d %>%
mutate(adj_pval = p.adjust(sorted_pval, method = "BH"))
d %>%
ggplot(aes(rank, adj_pval)) +
geom_point(aes(y = rev_pval, shape = "previous adjustment")) +
geom_point(aes(color = sig, shape = "correct adjustment")) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval)) +
scale_color_d3() +
scale_shape_manual(values = c(1, 19)) +
ylim(c(0, NA)) +
geom_hline(yintercept = alpha, color = "blue") +
theme_classic() +
theme(aspect.ratio = 1)
d <- d %>%
mutate(adj_pval = p.adjust(sorted_pval, method = "BH"))
d %>%
ggplot(aes(rank, adj_pval)) +
geom_point(aes(y = rev_pval, shape = "previous adjustment")) +
geom_point(aes(color = sig, shape = "correct adjustment")) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval)) +
scale_color_d3() +
scale_shape_manual(values = c(19, 1)) +
ylim(c(0, NA)) +
geom_hline(yintercept = alpha, color = "blue") +
theme_classic() +
theme(aspect.ratio = 1)
geom_segment
?geom_segment
d <- d %>%
mutate(adj_pval = p.adjust(sorted_pval, method = "BH"))
d %>%
ggplot(aes(rank, adj_pval)) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval),
arrow = T) +
geom_point(aes(y = rev_pval, shape = "previous adjustment")) +
geom_point(aes(color = sig, shape = "correct adjustment")) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval)) +
scale_color_d3() +
scale_shape_manual(values = c(19, 1)) +
ylim(c(0, NA)) +
geom_hline(yintercept = alpha, color = "blue") +
theme_classic() +
theme(aspect.ratio = 1)
d <- d %>%
mutate(adj_pval = p.adjust(sorted_pval, method = "BH"))
d %>%
ggplot(aes(rank, adj_pval)) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval),
arrow = arrow()) +
geom_point(aes(y = rev_pval, shape = "previous adjustment")) +
geom_point(aes(color = sig, shape = "correct adjustment")) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval)) +
scale_color_d3() +
scale_shape_manual(values = c(19, 1)) +
ylim(c(0, NA)) +
geom_hline(yintercept = alpha, color = "blue") +
theme_classic() +
theme(aspect.ratio = 1)
?arrow
d <- d %>%
mutate(adj_pval = p.adjust(sorted_pval, method = "BH"))
d %>%
ggplot(aes(rank, adj_pval)) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval),
arrow = arrow(type = "closed", size = 3)) +
geom_point(aes(y = rev_pval, shape = "previous adjustment")) +
geom_point(aes(color = sig, shape = "correct adjustment")) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval)) +
scale_color_d3() +
scale_shape_manual(values = c(19, 1)) +
ylim(c(0, NA)) +
geom_hline(yintercept = alpha, color = "blue") +
theme_classic() +
theme(aspect.ratio = 1)
d <- d %>%
mutate(adj_pval = p.adjust(sorted_pval, method = "BH"))
d %>%
ggplot(aes(rank, adj_pval)) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval),
arrow = arrow(type = "closed"), size = 3) +
geom_point(aes(y = rev_pval, shape = "previous adjustment")) +
geom_point(aes(color = sig, shape = "correct adjustment")) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval)) +
scale_color_d3() +
scale_shape_manual(values = c(19, 1)) +
ylim(c(0, NA)) +
geom_hline(yintercept = alpha, color = "blue") +
theme_classic() +
theme(aspect.ratio = 1)
d <- d %>%
mutate(adj_pval = p.adjust(sorted_pval, method = "BH"))
d %>%
ggplot(aes(rank, adj_pval)) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval),
arrow = arrow(type = "closed"), size = 1) +
geom_point(aes(y = rev_pval, shape = "previous adjustment")) +
geom_point(aes(color = sig, shape = "correct adjustment")) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval)) +
scale_color_d3() +
scale_shape_manual(values = c(19, 1)) +
ylim(c(0, NA)) +
geom_hline(yintercept = alpha, color = "blue") +
theme_classic() +
theme(aspect.ratio = 1)
d <- d %>%
mutate(adj_pval = p.adjust(sorted_pval, method = "BH"))
d %>%
ggplot(aes(rank, adj_pval)) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval),
arrow = arrow(length = unit(0.30, "cm"), type = "closed")) +
geom_point(aes(y = rev_pval, shape = "previous adjustment")) +
geom_point(aes(color = sig, shape = "correct adjustment")) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval)) +
scale_color_d3() +
scale_shape_manual(values = c(19, 1)) +
ylim(c(0, NA)) +
geom_hline(yintercept = alpha, color = "blue") +
theme_classic() +
theme(aspect.ratio = 1)
d <- d %>%
mutate(adj_pval = p.adjust(sorted_pval, method = "BH"))
d %>%
ggplot(aes(rank, adj_pval)) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval),
arrow = arrow(length = unit(0.1, "cm"), type = "closed")) +
geom_point(aes(y = rev_pval, shape = "previous adjustment")) +
geom_point(aes(color = sig, shape = "correct adjustment")) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval)) +
scale_color_d3() +
scale_shape_manual(values = c(19, 1)) +
ylim(c(0, NA)) +
geom_hline(yintercept = alpha, color = "blue") +
theme_classic() +
theme(aspect.ratio = 1)
d <- d %>%
mutate(adj_pval = p.adjust(sorted_pval, method = "BH"))
d %>%
ggplot(aes(rank, adj_pval)) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval),
arrow = arrow(length = unit(0.2, "cm"), type = "closed")) +
geom_point(aes(y = rev_pval, shape = "previous adjustment")) +
geom_point(aes(color = sig, shape = "correct adjustment")) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval)) +
scale_color_d3() +
scale_shape_manual(values = c(19, 1)) +
ylim(c(0, NA)) +
geom_hline(yintercept = alpha, color = "blue") +
theme_classic() +
theme(aspect.ratio = 1)
d <- d %>%
mutate(adj_pval = p.adjust(sorted_pval, method = "BH"))
d %>%
ggplot(aes(rank, adj_pval)) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval),
arrow = arrow(length = unit(0.1, "cm"), type = "closed")) +
geom_point(aes(y = rev_pval, shape = "previous adjustment")) +
geom_point(aes(color = sig, shape = "correct adjustment")) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval)) +
scale_color_d3() +
scale_shape_manual(values = c(19, 1)) +
ylim(c(0, NA)) +
geom_hline(yintercept = alpha, color = "blue") +
theme_classic() +
theme(aspect.ratio = 1)
d <- d %>%
mutate(adj_pval = p.adjust(sorted_pval, method = "BH"))
d %>%
ggplot(aes(rank, adj_pval)) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval),
arrow = arrow(length = unit(0.1, "cm"), type = "closed")) +
geom_point(aes(y = rev_pval, shape = "previous adjustment")) +
geom_point(aes(color = sig, shape = "correct adjustment")) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval)) +
scale_color_d3() +
scale_shape_manual(values = c(8, 1)) +
ylim(c(0, NA)) +
geom_hline(yintercept = alpha, color = "blue") +
theme_classic() +
theme(aspect.ratio = 1)
d <- d %>%
mutate(adj_pval = p.adjust(sorted_pval, method = "BH"))
d %>%
ggplot(aes(rank, adj_pval)) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval),
arrow = arrow(length = unit(0.1, "cm"), type = "closed")) +
geom_point(aes(y = rev_pval, shape = "previous adjustment")) +
geom_point(aes(color = sig, shape = "correct adjustment")) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval)) +
scale_color_d3() +
scale_shape_manual(values = c(4, 1)) +
ylim(c(0, NA)) +
geom_hline(yintercept = alpha, color = "blue") +
theme_classic() +
theme(aspect.ratio = 1)
d <- d %>%
mutate(adj_pval = p.adjust(sorted_pval, method = "BH"))
d %>%
ggplot(aes(rank, adj_pval)) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval),
arrow = arrow(length = unit(0.1, "cm"), type = "closed")) +
geom_point(aes(y = rev_pval, shape = "previous adjustment")) +
geom_point(aes(color = sig, shape = "correct adjustment")) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval)) +
scale_color_d3() +
scale_shape_manual(values = c(4, 19)) +
ylim(c(0, NA)) +
geom_hline(yintercept = alpha, color = "blue") +
theme_classic() +
theme(aspect.ratio = 1)
d <- d %>%
mutate(adj_pval = p.adjust(sorted_pval, method = "BH"))
d %>%
ggplot(aes(rank, adj_pval)) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval),
arrow = arrow(length = unit(0.1, "cm"), type = "closed")) +
geom_point(aes(y = rev_pval, shape = "previous adjustment")) +
geom_point(aes(color = sig, shape = "correct adjustment")) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval)) +
scale_color_d3() +
scale_shape_manual(values = c(19, 4)) +
ylim(c(0, NA)) +
geom_hline(yintercept = alpha, color = "blue") +
theme_classic() +
theme(aspect.ratio = 1)
d <- d %>%
mutate(adj_pval = p.adjust(sorted_pval, method = "BH"))
d %>%
ggplot(aes(rank, adj_pval)) +
geom_point(aes(y = rev_pval, shape = "previous adjustment")) +
geom_point(aes(color = sig, shape = "correct adjustment")) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval),
arrow = arrow(length = unit(0.1, "cm"), type = "closed")) +
scale_color_d3() +
scale_shape_manual(values = c(19, 4)) +
ylim(c(0, NA)) +
geom_hline(yintercept = alpha, color = "blue") +
theme_classic() +
theme(aspect.ratio = 1)
d <- d %>%
mutate(adj_pval = p.adjust(sorted_pval, method = "BH"))
d %>%
ggplot(aes(rank, adj_pval)) +
geom_point(aes(y = rev_pval, shape = "previous adjustment")) +
geom_point(aes(color = sig, shape = "correct adjustment")) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval),
arrow = arrow(length = unit(0.2, "cm"), type = "closed")) +
scale_color_d3() +
scale_shape_manual(values = c(19, 4)) +
ylim(c(0, NA)) +
geom_hline(yintercept = alpha, color = "blue") +
theme_classic() +
theme(aspect.ratio = 1)
d <- d %>%
mutate(adj_pval = p.adjust(sorted_pval, method = "BH"))
d %>%
ggplot(aes(rank, adj_pval)) +
geom_point(aes(y = rev_pval, shape = "previous adjustment")) +
geom_point(aes(color = sig, shape = "correct adjustment")) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval),
arrow = arrow(length = unit(0.1, "cm"), type = "closed")) +
scale_color_d3() +
scale_shape_manual(values = c(19, 4)) +
ylim(c(0, NA)) +
geom_hline(yintercept = alpha, color = "blue") +
theme_classic() +
theme(aspect.ratio = 1)
d <- d %>%
mutate(adj_pval = p.adjust(sorted_pval, method = "BH"))
d %>%
ggplot(aes(rank, adj_pval)) +
geom_point(aes(y = rev_pval, shape = "previous adjustment")) +
geom_point(aes(color = sig, shape = "correct adjustment")) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval),
arrow = arrow(length = unit(0.1, "cm"), type = "closed")) +
scale_color_d3() +
scale_shape_manual(values = c(19, 1)) +
ylim(c(0, NA)) +
geom_hline(yintercept = alpha, color = "blue") +
theme_classic() +
theme(aspect.ratio = 1)
d <- d %>%
mutate(adj_pval = p.adjust(sorted_pval, method = "BH"))
d %>%
ggplot(aes(rank, adj_pval)) +
geom_point(aes(y = rev_pval, shape = "previous adjustment")) +
geom_point(aes(color = sig, shape = "correct adjustment")) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval),
arrow = arrow(length = unit(0.1, "cm"))) +
scale_color_d3() +
scale_shape_manual(values = c(19, 1)) +
ylim(c(0, NA)) +
geom_hline(yintercept = alpha, color = "blue") +
theme_classic() +
theme(aspect.ratio = 1)
d %>%
ggplot(aes(rank, adj_pval)) +
geom_point(aes(y = rev_pval, shape = "previous adjustment")) +
geom_point(aes(color = sig, shape = "correct adjustment")) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval),
arrow = arrow(length = unit(0.1, "cm"))) +
scale_color_d3() +
scale_shape_manual(values = c(19, 1)) +
ylim(c(0, NA)) +
geom_hline(yintercept = alpha, color = "blue") +
theme_classic() +
theme(aspect.ratio = 1)
d %>%
ggplot(aes(rank, adj_pval)) +
geom_point(aes(y = rev_pval, shape = "previous adjustment")) +
geom_point(aes(color = sig, shape = "correct adjustment")) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval),
arrow = arrow(length = unit(0.2, "cm"))) +
scale_color_d3() +
scale_shape_manual(values = c(19, 1)) +
ylim(c(0, NA)) +
geom_hline(yintercept = alpha, color = "blue") +
theme_classic() +
theme(aspect.ratio = 1)
d <- d %>%
mutate(adj_pval = p.adjust(sorted_pval, method = "BH"))
d %>%
ggplot(aes(rank, adj_pval)) +
geom_point(aes(y = rev_pval, shape = "previous adjustment")) +
geom_point(aes(color = sig, shape = "correct adjustment")) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval),
arrow = arrow(length = unit(0.15, "cm"))) +
scale_color_d3() +
scale_shape_manual(values = c(19, 1)) +
ylim(c(0, NA)) +
geom_hline(yintercept = alpha, color = "blue") +
theme_classic() +
theme(aspect.ratio = 1)
d <- d %>%
mutate(adj_pval = p.adjust(sorted_pval, method = "BH"))
d %>%
ggplot(aes(rank, adj_pval)) +
geom_point(aes(y = rev_pval, shape = "previous adjustment")) +
geom_point(aes(color = sig, shape = "correct adjustment")) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval),
arrow = arrow(length = unit(0.15, "cm")),
lty = "dashed") +
scale_color_d3() +
scale_shape_manual(values = c(19, 1)) +
ylim(c(0, NA)) +
geom_hline(yintercept = alpha, color = "blue") +
theme_classic() +
theme(aspect.ratio = 1)
d <- d %>%
mutate(adj_pval = p.adjust(sorted_pval, method = "BH"))
d %>%
ggplot(aes(rank, adj_pval)) +
geom_point(aes(y = rev_pval, shape = "previous adjustment")) +
geom_point(aes(color = sig, shape = "correct adjustment")) +
geom_segment(data = d %>% filter(rev_pval > adj_pval),
aes(x = rank, y = rev_pval, xend = rank, yend = adj_pval),
arrow = arrow(length = unit(0.15, "cm"))) +
scale_color_d3() +
scale_shape_manual(values = c(19, 1)) +
ylim(c(0, NA)) +
geom_hline(yintercept = alpha, color = "blue") +
theme_classic() +
theme(aspect.ratio = 1)
d %>% filter(rev_pval > adj_pval)
blogdown:::update_meta_addin()
blogdown:::new_post_addin()
blogdown:::new_post_addin()
blogdown:::serve_site()
