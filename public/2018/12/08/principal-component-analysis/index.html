<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Hugo 0.80.0" />


<title>Principal component analysis - Jung-Jin Lee&#39;s blog</title>
<meta property="og:title" content="Principal component analysis - Jung-Jin Lee&#39;s blog">


  <link href='/bday.png' rel='icon' type='image/x-icon'/>



  








<link href='//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css' rel='stylesheet' type='text/css' />



<link rel="stylesheet" href="/css/fonts.css" media="all">
<link rel="stylesheet" href="/css/main.css" media="all">



  </head>
  <body>
    <div class="wrapper">
      <header class="header">
        <nav class="nav">
  <a href="/" class="nav-logo">
    <img src="/home.png"
         width="50"
         height="50"
         alt="Logo">
  </a>

  <ul class="nav-links">
    
    <li><a href="https://github.com/junglee0713">GitHub</a></li>
    
  </ul>
</nav>

      </header>


<main class="content" role="main">

  <article class="article">
    
    <span class="article-duration">5 min read</span>
    

    <h1 class="article-title">Principal component analysis</h1>

    
    <span class="article-date">2018-12-08</span>
    

    <div class="article-content">
      
<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/plotly-binding/plotly.js"></script>
<script src="/rmarkdown-libs/typedarray/typedarray.min.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="/rmarkdown-libs/crosstalk/js/crosstalk.min.js"></script>
<link href="/rmarkdown-libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="/rmarkdown-libs/plotly-main/plotly-latest.min.js"></script>


<p>A mock data set consisting of 100 data points, say <span class="math inline">\(\mathbf{P}_1, \cdots, \mathbf{P}_{100}\)</span>, is generated below. They depict a perturbed and slanted ellipse in <span class="math inline">\(\mathbb{R}^3\)</span>. Let <span class="math inline">\(X_{raw}\)</span> be the <span class="math inline">\(100 \times 3\)</span> matrix whose rows consist of <span class="math inline">\(\mathbf{P}_1, \cdots, \mathbf{P}_{100}\)</span>.</p>
<pre class="r"><code>set.seed(2018)
n &lt;- 100
## Create a perturbed and slanted ellipse in R^3
x_center &lt;- 3; y_center &lt;- 1; z_center &lt;- 2 
x_stretch &lt;- 4; y_stretch &lt;- 3; z_stretch &lt;- 1
angle &lt;- pi/3

x_ori &lt;- x_stretch*cos(2*pi*(1:n)/n) + rnorm(n, mean = 0, sd = 0.5) # stretch
y_ori &lt;- y_stretch*sin(2*pi*(1:n)/n) + rnorm(n, mean = 0, sd = 0.5) # stretch

x &lt;- cos(angle)*x_ori - sin(angle)*y_ori + x_center # rotate
y &lt;- sin(angle)*x_ori + cos(angle)*y_ori + y_center # rotate
z &lt;- z_stretch*sin(2*pi*(1:n)/n) + z_center # make it slanted

Xraw &lt;- data.frame(x, y, z) 
Xraw &lt;- Xraw[sample(nrow(Xraw)), ] # permute rows to randomize P1, P2, P3
dim(Xraw)</code></pre>
<pre><code>## [1] 100   3</code></pre>
<p>The following is an interactive 3D plot showing the distribution of points:</p>
<pre class="r"><code>library(plotly)
colored &lt;- c(&quot;P1&quot;, &quot;P2&quot;, &quot;P3&quot;, rep(&quot;P4 - P100&quot;, n-3))
plot_ly(Xraw, x = ~x, y = ~y, z = ~z, color = ~colored, 
        marker = list(size = 5), 
        colors = c(&quot;red&quot;, &quot;blue&quot;, &quot;green&quot;, &quot;grey&quot;)) %&gt;%
  add_markers()</code></pre>
<div id="htmlwidget-1" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"visdat":{"607318d2b67a":["function () ","plotlyVisDat"]},"cur_data":"607318d2b67a","attrs":{"607318d2b67a":{"x":{},"y":{},"z":{},"marker":{"size":5},"color":{},"colors":["red","blue","green","grey"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"x"},"yaxis":{"title":"y"},"zaxis":{"title":"z"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[0.017825627726987],"y":[-1.16414802787806],"z":[2.24868988716486],"marker":{"color":"rgba(255,0,0,1)","size":5,"line":{"color":"rgba(255,0,0,1)"}},"type":"scatter3d","mode":"markers","name":"P1","textfont":{"color":"rgba(255,0,0,1)"},"error_y":{"color":"rgba(255,0,0,1)"},"error_x":{"color":"rgba(255,0,0,1)"},"line":{"color":"rgba(255,0,0,1)"},"frame":null},{"x":[4.89466353367185],"y":[4.53983575721699],"z":[1.75131011283514],"marker":{"color":"rgba(0,0,255,1)","size":5,"line":{"color":"rgba(0,0,255,1)"}},"type":"scatter3d","mode":"markers","name":"P2","textfont":{"color":"rgba(0,0,255,1)"},"error_y":{"color":"rgba(0,0,255,1)"},"error_x":{"color":"rgba(0,0,255,1)"},"line":{"color":"rgba(0,0,255,1)"},"frame":null},{"x":[5.29132899574136],"y":[0.589540170534715],"z":[1.07022351411175],"marker":{"color":"rgba(0,255,0,1)","size":5,"line":{"color":"rgba(0,255,0,1)"}},"type":"scatter3d","mode":"markers","name":"P3","textfont":{"color":"rgba(0,255,0,1)"},"error_y":{"color":"rgba(0,255,0,1)"},"error_x":{"color":"rgba(0,255,0,1)"},"line":{"color":"rgba(0,255,0,1)"},"frame":null},{"x":[5.14797928237221,4.42027653876124,3.48867425597208,0.442602919337672,0.655761412747392,5.76567333899764,-0.411039018914412,2.79803425755944,-0.380433198905968,0.673721116136063,4.8413391454921,6.70426881650439,6.08491334703496,0.908191502986654,0.948888489025303,2.49998765347982,2.44112094174331,5.71223920641094,0.653545073635732,0.911086041763184,0.25265039145539,1.3651047108199,3.07384481943688,-0.482171890931771,4.75707035087797,6.30783228332147,4.43381951118106,-0.0882987282869294,-0.270546444547178,4.56656494960458,3.10979319380268,4.17390132472588,2.38916192142564,6.47593663910682,1.24629035679724,5.44221436904682,5.16660827340321,0.106665723646623,5.62842187551971,6.69576265553773,5.91136261877037,5.56281764086842,0.822633924866327,6.16889821555059,5.7771819125168,0.452913193180484,3.32940956559783,0.389354389484775,6.0682687509456,1.9057939498156,3.33796384085278,0.0251391579948792,4.84706337528483,5.378109895472,-0.787358574024011,4.2534085092811,-0.216676320437552,-0.282979036325697,-0.126064144813252,-0.0492900325231891,1.59940692153272,7.33973266348876,0.684678258373648,6.80167744316263,5.75408673183086,0.679700698095822,-0.240390333310843,4.60596738852857,1.09202521977944,5.85247722142875,3.0178910233008,6.57842658313023,2.96821823796151,-0.761406629953996,5.7926575035895,6.40756589289621,1.0602605651749,0.421954316370179,2.32616996743777,5.47745842280043,1.91085594781571,1.51346319667235,3.2516500776842,-0.352431754633641,4.58482599398983,-1.2554686960069,2.86160937329972,1.52233757945625,4.26458999980675,4.6498307876647,4.77451085252127,3.97957103782947,0.0445479046736694,3.68160324261423,5.41568999915422,1.99493788035069,3.17666907181312],"y":[3.25807624686404,-2.83039205952396,4.85948633299151,2.04786226255519,1.6492493286125,-1.09671799700753,0.590506796793255,-1.94697898536002,3.67952201824089,-1.51292948993634,5.08854322718006,1.90381260946719,0.994145466795791,-2.99998034992789,-2.76463843401553,-2.41096586945791,4.8958078740282,-1.02328988117614,3.08268498569797,3.52693064921947,1.39607495806516,3.82224864419247,-1.51492620085347,-0.977332695130136,5.37690207353696,-0.908100679084271,-0.776756414757989,0.435607451727644,-0.847748777795978,4.46102139051606,-2.09027865744506,-1.59484605536265,-2.67872574438232,3.41868364816537,-1.67953215999183,4.6108012670642,-0.790061860221978,-1.80809167209429,4.58712703587451,2.00159085756443,0.613818076073097,-1.06205345176099,3.26703193967402,4.20071752960753,2.51953454254792,-2.5614480326551,3.58208979844876,1.88392566992829,-0.373734329300031,3.60727472118013,-3.29999482385361,-0.67249735237827,-0.609749890079285,2.63387567082434,-0.0402836750088862,-1.07186229146657,-1.94062588289982,1.06326066645559,-1.87660288215157,-2.20607813764792,-2.70030345966448,3.15588768509237,-1.85612586085068,1.723747789829,3.30593386075901,1.05354617480499,1.07876764102951,4.70288170824026,3.64690750500257,2.68564565858178,-2.20686581853361,0.985492951420787,4.20594117945685,-0.935658630503026,1.35046282732533,0.12980513185627,-2.76699217801976,-1.19728189584946,4.24764820631085,3.79980276121217,4.31558626978539,3.71294421132741,5.40065299989692,0.765571671250886,-2.67617164873277,2.15180971891237,4.62716085348438,-2.86581091946506,-1.94602065233089,5.44207812761886,4.47527786602122,4.12200334269876,-2.2472675734094,-2.47017892527328,4.02271951959349,2.75042774895425,5.00249372565404],"z":[1.69098300562505,1.15567207449798,2.36812455268468,2.99802672842827,3,1.00788529868552,2.87630668004386,1.27103137257859,2.92977648588825,2.58778525229247,2,1.15567207449798,1.12369331995614,1.75131011283515,1.93720948047069,1.464173205021,2.72896862742141,1.07022351411175,2.99211470131448,2.99802672842827,2.99211470131448,2.96858316112863,1.51824632589828,2.68454710592869,2.42577929156507,1.00197327157173,1.03141683887137,2.72896862742141,2.80901699437495,2.06279051952931,1.31545289407131,1.09517294753398,1.63187544731532,1.51824632589828,2,1.8746667664357,1.01771274927131,2.30901699437495,1.81261868541428,1.36257601025131,1.01771274927131,1.00788529868552,2.98228725072869,1.57422070843493,1.31545289407131,2.1253332335643,2.68454710592869,2.98228725072869,1,2.90482705246602,1.41221474770753,2.63742398974869,1.00197327157173,1.19098300562505,2.77051324277579,1.12369331995614,2.48175367410172,2.92977648588825,2.42577929156507,2.06279051952931,1.69098300562505,1.27103137257859,1.81261868541428,1.09517294753398,1.41221474770753,2.90482705246602,2.95105651629515,2.24868988716485,2.95105651629515,1.464173205021,1.22948675722421,1.04894348370485,2.63742398974869,2.535826794979,1.22948675722421,1.03141683887137,1.8746667664357,2.36812455268468,2.80901699437495,1.93720948047069,2.77051324277579,2.84432792550202,2.48175367410172,2.84432792550201,1.19098300562505,2.96858316112863,2.535826794979,1.57422070843493,1.04894348370485,2.30901699437495,2.18738131458572,2.1253332335643,2.18738131458572,1.36257601025131,1.63187544731532,2.87630668004386,2.58778525229247],"marker":{"color":"rgba(190,190,190,1)","size":5,"line":{"color":"rgba(190,190,190,1)"}},"type":"scatter3d","mode":"markers","name":"P4 - P100","textfont":{"color":"rgba(190,190,190,1)"},"error_y":{"color":"rgba(190,190,190,1)"},"error_x":{"color":"rgba(190,190,190,1)"},"line":{"color":"rgba(190,190,190,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>Our goal is to find a <em>good</em> (meaning to be clarified <a href="#later">later</a>) two dimensional representation <span class="math inline">\(\mathbf{Q}_1, \cdots, \mathbf{Q}_{100}\)</span> of <span class="math inline">\(\mathbf{P}_1, \cdots, \mathbf{P}_{100}\)</span> so that we can reduce the dimension (from 3 to 2) of data and visualize them. If <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span>, and <span class="math inline">\(z\)</span> variables need to be equally weighted, then the data points should be centered and normalized. Let <span class="math inline">\(X\)</span> be the centered and normalized version of <span class="math inline">\(X_{raw}\)</span>.</p>
<pre class="r"><code>X &lt;- scale(Xraw) %&gt;%
  as.data.frame()
plot_ly(X, x = ~x, y = ~y, z = ~z, color = ~colored, 
        marker = list(size = 5), 
        colors = c(&quot;red&quot;, &quot;blue&quot;, &quot;green&quot;, &quot;grey&quot;)) %&gt;%
  add_markers() </code></pre>
<div id="htmlwidget-2" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"visdat":{"607348f54f60":["function () ","plotlyVisDat"]},"cur_data":"607348f54f60","attrs":{"607348f54f60":{"x":{},"y":{},"z":{},"marker":{"size":5},"color":{},"colors":["red","blue","green","grey"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"x"},"yaxis":{"title":"y"},"zaxis":{"title":"z"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[-1.20900759090407],"y":[-0.817133261530381],"z":[0.349937689820024],"marker":{"color":"rgba(255,0,0,1)","size":5,"line":{"color":"rgba(255,0,0,1)"}},"type":"scatter3d","mode":"markers","name":"P1","textfont":{"color":"rgba(255,0,0,1)"},"error_y":{"color":"rgba(255,0,0,1)"},"error_x":{"color":"rgba(255,0,0,1)"},"line":{"color":"rgba(255,0,0,1)"},"frame":null},{"x":[0.801101967861935],"y":[1.29700991584019],"z":[-0.349937689820024],"marker":{"color":"rgba(0,0,255,1)","size":5,"line":{"color":"rgba(0,0,255,1)"}},"type":"scatter3d","mode":"markers","name":"P2","textfont":{"color":"rgba(0,0,255,1)"},"error_y":{"color":"rgba(0,0,255,1)"},"error_x":{"color":"rgba(0,0,255,1)"},"line":{"color":"rgba(0,0,255,1)"},"frame":null},{"x":[0.964597464803981],"y":[-0.167140540723958],"z":[-1.30831148475705],"marker":{"color":"rgba(0,255,0,1)","size":5,"line":{"color":"rgba(0,255,0,1)"}},"type":"scatter3d","mode":"markers","name":"P3","textfont":{"color":"rgba(0,255,0,1)"},"error_y":{"color":"rgba(0,255,0,1)"},"error_x":{"color":"rgba(0,255,0,1)"},"line":{"color":"rgba(0,255,0,1)"},"frame":null},{"x":[0.905512329179844,0.605571615733217,0.221588655930512,-1.03392510699117,-0.946066553272846,1.16011023699674,-1.38577477945053,-0.0630757289126033,-1.37315983252398,-0.938664016598382,0.779123000247532,1.54697561524748,1.29169291496808,-0.842021238030448,-0.825246967032117,-0.185923020410208,-0.210186393980704,1.13808603550627,-0.94698007234396,-0.84082818216615,-1.11221874712682,-0.653693140130689,0.0506064269291262,-1.4150939548552,0.744389528923198,1.38357447701738,0.611153687321446,-1.25274937329577,-1.32786728444706,0.665868008322854,0.0654234399872591,0.504021967718095,-0.231602591405955,1.45286285176989,-0.702665419576027,1.02678860935475,0.913190729336617,-1.17238994450002,1.10353864613962,1.54346959027858,1.22015968287312,1.07649823558849,-0.877285913404402,1.3263093591171,1.1648537806791,-1.02967547220637,0.155943768265713,-1.0558728077169,1.2848324323467,-0.430834675570627,0.159469624730479,-1.20599313822318,0.78148238336521,1.00036636248545,-1.54088420680186,0.536792823495401,-1.30566337824942,-1.33299168514608,-1.26831532529467,-1.23667097295892,-0.557119679524229,1.80889778237885,-0.934147758979551,1.58712499386703,1.15533452981336,-0.936199383759123,-1.31543769613175,0.682108699657552,-0.766249617469057,1.19588860756758,0.0275436836861547,1.49510662122299,0.00706981464504795,-1.53018747013564,1.17123242892264,1.4246821549437,-0.77934220678265,-1.04243594024022,-0.257566285766599,1.04131531922416,-0.428748247692009,-0.592543514843261,0.123893268955616,-1.36161834357631,0.673394750154296,-1.73382739025397,-0.0368716699888023,-0.588885718130286,0.541401551819028,0.700188086256814,0.751578063735918,0.423923925752821,-1.19799334245897,0.30110911728103,1.01585593320483,-0.394091796202804,0.0929879898517905],"y":[0.821934385134176,-1.43471539080355,1.41548624911487,0.373376721844399,0.225633522274176,-0.792140774685079,-0.166782267210822,-1.10728428407004,0.978140422135242,-0.946406761628798,1.50038464439849,0.319985688006894,-0.0171763124150416,-1.4975721485763,-1.41034425231622,-1.27925789801478,1.42894858369845,-0.764925138042183,0.756926795327626,0.921583458809845,0.131796146793483,1.03104108487435,-0.947146829083698,-0.747891416525619,1.60726290889373,-0.72223103601026,-0.673549168954858,-0.224194666314298,-0.69986201022807,1.26779790158535,-1.16039734249943,-0.976768584949932,-1.37850129246907,0.881462436841418,-1.00815691932559,1.32331280415908,-0.678480742712672,-1.0558066367227,1.31453810979898,0.356226537192016,-0.158142098531865,-0.779292594432336,0.825253752363499,1.17131802851471,0.548198876021477,-1.33503309840554,0.942027826011132,0.312614727792243,-0.524171747068235,0.951362448017644,-1.60877049293693,-0.634906249599949,-0.611649325261672,0.590578645204925,-0.400580507625812,-0.782928174813131,-1.10492954942713,0.00844077089350217,-1.08119985535254,-1.20331764000337,-1.38649892732669,0.784058882886182,-1.07361018530663,0.25324587522599,0.839672487434829,0.00484015998391402,0.0141883265900635,1.35744179957984,0.966052072440728,0.609766842530439,-1.20360958861914,-0.0203833089697932,1.17325413915351,-0.732445205118965,0.114890317702433,-0.337538236797359,-1.41121665168047,-0.829414106559197,1.18871256778759,1.02272166950594,1.2138933534963,0.990528132926297,1.61606602980219,-0.101895650439756,-1.37755463411671,0.411904146525514,1.32937637469467,-1.44784315271802,-1.10692908438654,1.63141997442137,1.27308196822336,1.14214314522519,-1.21858422698463,-1.3012048183918,1.10534426480239,0.633777888062273,1.46849097614461],"z":[-0.434825454140857,-1.1880747024701,0.517997161047049,1.4043480887235,1.40712472794703,-1.39602912917938,1.23307279875489,-1.02574978154227,1.30831148475705,0.827087163223322,-3.1244445429724e-16,-1.1880747024701,-1.23307279875489,-0.349937689820023,-0.0883540927103375,-0.753975133111549,1.02574978154227,-1.30831148475705,1.39602912917938,1.4043480887235,1.39602912917938,1.3629173170972,-0.677887507607858,0.963243160196832,0.599124569808982,-1.40434808872349,-1.3629173170972,1.02574978154227,1.13838781811437,0.0883540927103378,-0.963243160196831,-1.27320452004036,-0.517997161047049,-0.677887507607859,0,-0.176359492181894,-1.38220068044744,0.434825454140856,-0.263668881308794,-0.896935058162035,-1.38220068044744,-1.39602912917938,1.38220068044744,-0.599124569808982,-0.963243160196832,0.176359492181894,0.963243160196832,1.38220068044744,-1.40712472794703,1.27320452004036,-0.827087163223321,0.896935058162035,-1.40434808872349,-1.13838781811437,1.08420823712047,-1.23307279875489,0.677887507607858,1.30831148475705,0.599124569808982,0.0883540927103378,-0.434825454140856,-1.02574978154227,-0.263668881308795,-1.27320452004036,-0.827087163223322,1.27320452004036,1.33825514175407,0.349937689820023,1.33825514175407,-0.75397513311155,-1.08420823712047,-1.33825514175407,0.896935058162035,0.75397513311155,-1.08420823712047,-1.3629173170972,-0.176359492181893,0.51799716104705,1.13838781811437,-0.0883540927103375,1.08420823712047,1.1880747024701,0.677887507607858,1.1880747024701,-1.13838781811437,1.3629173170972,0.753975133111549,-0.599124569808981,-1.33825514175407,0.434825454140856,0.263668881308795,0.176359492181893,0.263668881308794,-0.896935058162035,-0.517997161047049,1.23307279875489,0.827087163223322],"marker":{"color":"rgba(190,190,190,1)","size":5,"line":{"color":"rgba(190,190,190,1)"}},"type":"scatter3d","mode":"markers","name":"P4 - P100","textfont":{"color":"rgba(190,190,190,1)"},"error_y":{"color":"rgba(190,190,190,1)"},"error_x":{"color":"rgba(190,190,190,1)"},"line":{"color":"rgba(190,190,190,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p><a name="later"></a> Consider a projection <span class="math inline">\(P\)</span> onto a two dimensional subspace <span class="math inline">\(W\)</span> of <span class="math inline">\(\mathbb{R}^3\)</span> and let <span class="math inline">\(Y=XP\)</span>. Since <span class="math inline">\(X\)</span> is centered, so is <span class="math inline">\(Y\)</span> and hence the total variance of <span class="math inline">\(Y\)</span> is given by <span class="math inline">\(\frac{1}{n-1}\|Y\|_{HS}^2\)</span>, where <span class="math inline">\(\|\cdot\|_{HS}\)</span> denotes the Hilbert-Schmidt norm.
By a good two dimensional representation, we mean finding a projection <span class="math inline">\(P\)</span> such that <span class="math inline">\(\frac{1}{n-1}\|Y\|_{HS}^2\)</span> is maximized, where <span class="math inline">\(Y=XP\)</span>. As <span class="math inline">\(P\)</span> is a projection matrix, <span class="math inline">\(P=P^t=P^2\)</span> and it follows that
<span class="math display">\[\|Y\|_{HS}^2=tr((XP)^t(XP))=tr(P^tX^tXP)=tr(X^tXPP^t)=tr(X^tY)\]</span> and that</p>
<p><span class="math display">\[\begin{align}
\|X-Y\|_{HS}^2&amp;=tr((X-Y)^t(X-Y))\\
&amp;=tr(X^tX)-tr(X^tY)-tr(Y^tX)+tr(Y^tY)\\
&amp;=tr(X^tX)-tr(X^tY)-tr((Y^tX)^t)+tr(Y^tY)\\
&amp;=tr(X^tX)-2tr(X^tY)+tr(Y^tY)\\
&amp;=\|X\|_{HS}^2-\|Y\|_{HS}^2,
\end{align}\]</span></p>
<p>which implies that <span class="math inline">\(\|Y\|_{HS}^2\)</span> is maximized when <span class="math inline">\(\|X-Y\|_{HS}^2\)</span> is minimized.</p>
<p>Let <span class="math inline">\(X=U\Sigma V^t\)</span> be a <a href="https://en.wikipedia.org/wiki/Singular_value_decomposition">singular value decomposition</a>, where <span class="math inline">\(U\)</span> is a <span class="math inline">\(100 \times 100\)</span> orthogonal matrix, <span class="math inline">\(V\)</span> is a <span class="math inline">\(3 \times 3\)</span> orthogonal matrix, and
<span class="math display">\[\Sigma=\left[\begin{array}{ccc} \sigma_1 &amp; &amp; \\ &amp; \sigma_2 &amp;  \\ &amp; &amp; \sigma_3 \\ &amp; &amp; \\ &amp; &amp; \end{array}\right]_{100\times 3}\]</span> with
<span class="math display">\[\sigma_1\geq \sigma_2\geq \sigma_3.\]</span>
On one hand, by <a href="https://en.wikipedia.org/wiki/Low-rank_approximation">Eckart–Young–Mirsky theorem</a>,
<span class="math display">\[\min_{rank(Y)=2} \|X-Y\|_{HS}^2 = \sigma_3^2\]</span>
On the other hand, let <span class="math inline">\(Y_0=XP_0\)</span>, where <span class="math inline">\(P_0=VQV^t\)</span> and
<span class="math display">\[Q=\left[\begin{array}{ccc} 1 &amp; &amp; \\ &amp; 1 &amp;  \\ &amp; &amp; 0 \end{array}\right],\]</span>
then <span class="math inline">\(P_0\)</span> is a projection of rank 2 satisfying <span class="math inline">\(\|X-Y_0\|_{HS}^2 = \sigma_3^2\)</span>. This is our desired projection!</p>
<p>Note that <span class="math inline">\(XP_0=U\Sigma V^tVQV^t = U\Sigma_0V^t\)</span>, where <span class="math display">\[\Sigma_0=\left[\begin{array}{ccc} \sigma_1 &amp; &amp; \\ &amp; \sigma_2 &amp;  \\ &amp; &amp; 0 \\ &amp; &amp; \\ &amp; &amp; \end{array}\right]_{100 \times 3}.\]</span></p>
<p>In particular, this shows that the first two columns of <span class="math inline">\(V\)</span> are basis for <span class="math inline">\(W\)</span>, the subspace associated with <span class="math inline">\(P\)</span>, and the first two columns of <span class="math inline">\(U\Sigma_0\)</span> provide the desired coordinates <span class="math inline">\(\mathbf{Q}_1, \cdots, \mathbf{Q}_{100}\)</span>. This can be obtained as in the following using an R function <code>svd()</code>:</p>
<pre class="r"><code>SVD &lt;- svd(X, nu = n)
U &lt;- SVD$u # 100 x 100
Sigma &lt;- rbind(diag(SVD$d), matrix(0, nrow = n-3, ncol = 3)) # 100 x 3
V &lt;- SVD$v
X_recover &lt;- (U %*% Sigma) %*% t(V) # This recovers X 
Q &lt;- U %*% Sigma # The first two columns of Q gives coordinates Q1, Q2, ..., Q100
head(Q[, 1:2])</code></pre>
<pre><code>##            [,1]        [,2]
## [1,] -0.9820798 -1.11947787
## [2,]  0.6511191  1.39539259
## [3,]  1.6230094 -0.06577025
## [4,]  0.8372228  0.98977697
## [5,]  1.4352549 -1.31595259
## [6,] -0.3854602  1.46886795</code></pre>
<p><strong>Remark</strong>: <span class="math inline">\(U\Sigma\)</span> (and hence <span class="math inline">\(U\Sigma_0\)</span>) can be computed from the <a href="https://en.wikipedia.org/wiki/Diagonalizable_matrix#Diagonalizable_matrices">orthogonal diagonalization</a> of <span class="math inline">\(XX^t\)</span>, as<br />
<span class="math display">\[XX^t = U\Sigma V^t(V\Sigma^tU^t) = U\Lambda U^t,\]</span>
where <span class="math display">\[\Lambda = \Sigma\Sigma^t= \left[\begin{array}{ccccc} \sigma_1^2 &amp; &amp; &amp; &amp;\\ &amp; \sigma_2^2 &amp; &amp; &amp; \\ &amp; &amp; \sigma_3^2 &amp; &amp; \\ &amp; &amp; &amp; 0 &amp; \\ &amp; &amp; &amp; &amp; \ddots  \end{array}\right]_{100 \times 100}.\]</span></p>
<p>The R function <code>prcomp()</code> easily computes the coordinates <span class="math inline">\(\mathbf{Q}_1, \cdots, \mathbf{Q}_{100}\)</span> from <span class="math inline">\(X_{raw}\)</span>:</p>
<pre class="r"><code>Y &lt;- prcomp(Xraw, center = T, scale = T)$x %&gt;%
  as.data.frame() # PC1 and PC2 of Y represent coordinates of Q1, Q2, ..., Q100 
head(Y)</code></pre>
<pre><code>##           PC1         PC2         PC3
## 46 -0.9820798 -1.11947787 -0.18480021
## 96  0.6511191  1.39539259 -0.27455226
## 81  1.6230094 -0.06577025 -0.17770174
## 95  0.8372228  0.98977697 -0.06325721
## 66  1.4352549 -1.31595259  0.21203509
## 6  -0.3854602  1.46886795 -0.12194797</code></pre>
<p>The projected points on the PC1-PC2 plane viewed from PC3 axis:</p>
<pre class="r"><code>scene &lt;- list(camera = list(up = list(x = 1, y = 0, z = 0),
                           eye = list(x = 0, y = 0, z = 2)))
plot_ly(Y, x = ~PC1, y = ~PC2, z = ~PC3, color = ~colored,
        marker = list(size = 5), 
        colors = c(&quot;red&quot;, &quot;blue&quot;, &quot;green&quot;, &quot;grey&quot;)) %&gt;%
  add_markers() %&gt;%
  layout(scene = scene)</code></pre>
<div id="htmlwidget-3" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-3">{"x":{"visdat":{"6073784ddf88":["function () ","plotlyVisDat"]},"cur_data":"6073784ddf88","attrs":{"6073784ddf88":{"x":{},"y":{},"z":{},"marker":{"size":5},"color":{},"colors":["red","blue","green","grey"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"camera":{"up":{"x":1,"y":0,"z":0},"eye":{"x":0,"y":0,"z":2}},"xaxis":{"title":"PC1"},"yaxis":{"title":"PC2"},"zaxis":{"title":"PC3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[-0.982079776175404],"y":[-1.11947787208457],"z":[-0.184800205248236],"marker":{"color":"rgba(255,0,0,1)","size":5,"line":{"color":"rgba(255,0,0,1)"}},"type":"scatter3d","mode":"markers","name":"P1","textfont":{"color":"rgba(255,0,0,1)"},"error_y":{"color":"rgba(255,0,0,1)"},"error_x":{"color":"rgba(255,0,0,1)"},"line":{"color":"rgba(255,0,0,1)"},"frame":null},{"x":[0.651119078942234],"y":[1.39539258739913],"z":[-0.274552260099213],"marker":{"color":"rgba(0,0,255,1)","size":5,"line":{"color":"rgba(0,0,255,1)"}},"type":"scatter3d","mode":"markers","name":"P2","textfont":{"color":"rgba(0,0,255,1)"},"error_y":{"color":"rgba(0,0,255,1)"},"error_x":{"color":"rgba(0,0,255,1)"},"line":{"color":"rgba(0,0,255,1)"},"frame":null},{"x":[1.62300940770707],"y":[-0.0657702484712127],"z":[-0.177701737519173],"marker":{"color":"rgba(0,255,0,1)","size":5,"line":{"color":"rgba(0,255,0,1)"}},"type":"scatter3d","mode":"markers","name":"P3","textfont":{"color":"rgba(0,255,0,1)"},"error_y":{"color":"rgba(0,255,0,1)"},"error_x":{"color":"rgba(0,255,0,1)"},"line":{"color":"rgba(0,255,0,1)"},"frame":null},{"x":[0.83722277249186,1.43525489957327,-0.385460163233722,-1.76304487475641,-1.6887633731696,1.88991143419557,-1.8164738313368,0.826764320427275,-1.99180441495787,-1.13038316318833,0.35924156230957,1.87589265856185,1.77340824691979,-0.148237215884023,-0.336573585924649,0.565561309247327,-1.04850107209618,1.80822501874448,-1.74132038539632,-1.69392374153647,-1.78285306172578,-1.5492344018533,0.633325283429088,-1.57489772712366,-0.111265167914868,2.03968269696028,1.48000407106792,-1.56924544774327,-1.64826287338306,0.244526017285777,0.874581850106986,1.37643260221676,0.374489277086974,1.37831918286499,-0.362942682782893,0.675293206414416,1.69949834523529,-0.991899194180273,0.791734072208511,1.65809964178332,1.84903160326552,1.83172756698723,-1.6917087424547,1.20255047355466,1.42765088904448,-0.675928631004344,-0.699720775013778,-1.75500052641358,1.95233500986651,-1.3239042181107,0.890194783408285,-1.39764523653426,1.61865980172395,1.43838389521171,-1.78726827556724,1.34765175347482,-1.25320742921874,-1.85505581056505,-1.17337554325725,-0.767375386597651,0.094150054138502,1.88339102623689,-0.32123692263187,1.97246202484932,1.28945213391721,-1.55993222066647,-1.8655283367016,0.0555547960984666,-1.60036806151907,1.28986103610902,0.941560429364804,1.98813831158085,-0.778715503398791,-1.50284011756693,1.5687076733093,1.99406566488736,-0.241449207187078,-0.989654443327549,-1.1352811286087,0.655212970855863,-1.21495031290262,-1.37625967827882,-0.590453113762277,-1.77474806160154,1.43875560658918,-2.21222649662187,-0.722392950641756,0.198778082562825,1.46370935088846,-0.0247292696971697,0.174834894863503,0.0306701685755485,-0.866658874001672,1.00227118066583,0.940462573834152,-1.23398378778939,-0.70305549563952],"y":[0.989776965836733,-1.31595259288138,1.46886795490228,0.245513805878184,0.146790891136401,-0.57204675120578,-0.411156450344038,-1.24129984250103,0.639073027747884,-1.0294159567284,1.64554631830367,0.620030275004867,0.20995039555071,-1.7427064007727,-1.60130533658423,-1.38388674864605,1.42630798500083,-0.536995133979106,0.621608020153716,0.811863487766824,-0.00327111220915749,0.972595947240646,-0.978765797409713,-1.00305951466621,1.85802140692044,-0.425854655866959,-0.667465331877855,-0.456934204734322,-0.888750675566276,1.41244193279701,-1.22655127501108,-0.96143234501672,-1.43943896600912,1.19926120730265,-1.17396071591195,1.54259385946865,-0.560978187013159,-1.30169377541114,1.54506021031673,0.714267889054996,0.0237130279461631,-0.5923585826878,0.706590439331411,1.42862424702563,0.72820575882,-1.55422898877269,1.114617413173,0.177740790968187,-0.286051081274459,0.966483762597982,-1.56428404625307,-0.83616910522482,-0.555885499049705,0.665722885472204,-0.712628685046612,-0.766022788333459,-1.34403912533281,-0.217259280827996,-1.32552040084846,-1.53375272564187,-1.55267069023389,1.17210493482958,-1.37805582818704,0.55691801561193,1.01603850210203,-0.0768927960924407,-0.198924627131654,1.55581135704595,0.865952329682941,0.840655619175785,-1.30600269208732,0.261819781892917,1.25138387891613,-1.07831422128171,0.31497147113349,-0.0554348225095002,-1.60364015083829,-1.03067874104875,1.21668449802453,1.29697839337345,1.16236566921451,0.921648284619883,1.64653430977801,-0.353363400621559,-1.22797652562663,0.00447925336687821,1.34404004464699,-1.65546756733599,-1.07826251049658,1.82734091653141,1.48778696415863,1.22634299398004,-1.49480207992656,-1.24896252227849,1.26857696905759,0.686332237566004,1.53439045806671],"z":[-0.0632572086918017,0.212035090443647,-0.121947965723901,0.109547242328109,0.229091932017769,0.152438130900484,0.0054575136680961,-0.24053088603281,-0.422263413024276,0.35126309583475,-0.145977891778669,0.0602916659257537,0.0133476769925704,-0.123201545343966,0.0211979390616744,-0.0674130025034828,-0.067275724733896,0.184357641121056,-0.00368036719008169,-0.00130110271235417,0.157233442394583,0.0428245831450436,-0.00980808090433333,0.0569088462783945,0.178147672056321,0.257743797071824,-0.220904744479117,-0.0220615573247114,0.205710767350676,-0.0609342499563001,-0.0965306266301772,-0.101222032429485,0.099999385093726,0.0965751178695552,-0.0144191664757782,-0.0306197082747413,-0.0417252399106406,-0.00532121430450294,-0.0357123229195913,0.232841536366773,-0.0692612337273368,0.0944889323397669,0.00212894927105456,-0.0542015637958014,-0.129510754501256,0.0337691964897233,0.328010866850174,0.107030082930079,0.110059928156246,0.157941549082281,0.241277653245841,0.0970922965184668,-0.167197264133778,-0.365113173618555,-0.0901601447462309,-0.136511642037125,0.0904854043218228,0.0135412337704133,0.052465637904889,-0.209457576686454,-0.0467363172957634,0.134277314913414,-0.304238588132767,0.0581794958881662,-0.169999688486415,0.24133260862657,0.0416831276531925,0.0821071864634344,-0.0164480319817233,0.000550259927360741,-0.181005866981793,0.0737737648123092,0.0933183167190841,-0.158550291155547,-0.0210213504371929,0.147729556045528,-0.00706616613467063,0.0347408127265981,0.0782328326390845,0.163238056136658,-0.075308852140213,-0.0157808476254298,-0.16383014043888,-0.0362265197640194,0.262868866473639,-0.373362989993144,-0.0937248645937458,-0.147989328772003,-0.0651103462083725,0.0328831664564694,0.105125027908885,-0.102212187966311,-0.0642338210273858,0.154396492273732,-0.168264376520095,0.289280751884442,-0.0233362612368854],"marker":{"color":"rgba(190,190,190,1)","size":5,"line":{"color":"rgba(190,190,190,1)"}},"type":"scatter3d","mode":"markers","name":"P4 - P100","textfont":{"color":"rgba(190,190,190,1)"},"error_y":{"color":"rgba(190,190,190,1)"},"error_x":{"color":"rgba(190,190,190,1)"},"line":{"color":"rgba(190,190,190,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>Finally, one can get the following 2D plot as a result of dimension reduction:</p>
<pre class="r"><code>Y %&gt;% mutate(color_code = colored) %&gt;%
  ggplot(aes(PC1, PC2, color = color_code)) +
  scale_color_manual(values = c(&quot;red&quot;, &quot;blue&quot;, &quot;green&quot;, &quot;grey&quot;)) +
  theme(aspect.ratio = 1) +
  geom_point()</code></pre>
<p><img src="/post/2018-12-08-principal-component-analysis_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>

    </div>
  </article>

  
<section id="comments">
  <div id="disqus_thread"></div>
  <script>
  var disqus_config = function () {
  
  };
  (function() {
    var inIFrame = function() {
      var iframe = true;
      try { iframe = window.self !== window.top; } catch (e) {}
      return iframe;
    };
    if (inIFrame()) return;
    var d = document, s = d.createElement('script');
    s.src = '//junglee0713-netlify.disqus.com/embed.js'; s.async = true;
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>



</main>

      <footer class="footer">
        <ul class="footer-links">
          <li>
            <a href="/index.xml" type="application/rss+xml" target="_blank">RSS feed</a>
          </li>
          <li>
            <a href="https://gohugo.io/" class="footer-links-kudos">Made with <img src="/images/hugo-logo.png" alt="Img link to Hugo website" width="22" height="22"></a>
          </li>
        </ul>
      </footer>

    </div>
    



<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>



<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>



    
<script src="/js/math-code.js"></script>
<script async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>


    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-129677462-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

  </body>
</html>

